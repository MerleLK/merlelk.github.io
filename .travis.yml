language: node_js

node_js: stable

install:
  - npm install
  - sh init_env.sh

before_install:
    - git clone --branch=master https://github.com/MerleLiuKun/merleliukun.github.io .deploy_git
    - git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly

script:
  - hexo clean
  - hexo generate

after_script:
  - git config --global user.name "ikaroskun"
  - git config --global user.email "merle.liukun@gmail.com"
  - sed -i "s/__GITHUB_TOKEN__/${GITHUB_TOKEN}/" _config.yml
  - hexo deploy

branches:
  only:
    - gh-pages

notifications:
  email: true